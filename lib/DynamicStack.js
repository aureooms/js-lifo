"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.default = DynamicStack;

/**
 * DynamicStack#peek only valid if DynamicStack#empty is false.
 * DynamicStack#pop only valid if DynamicStack#empty is false.
 */

function DynamicStack(array, capacity, growthrate, realloc) {

	this.array = array;
	this.capacity = capacity;
	this.length = 0;

	this.growthrate = growthrate;
	this.grs = growthrate * growthrate;
	this.realloc = realloc;
}

DynamicStack.prototype.empty = function () {

	return this.length === 0;
};

/**
 * Only valid if DynamicStack#empty is false.
 */

DynamicStack.prototype.peek = function () {

	return this.array[this.length - 1];
};

DynamicStack.prototype.grow = function (len) {

	if (this.capacity < len) {

		this.capacity = len * this.growthrate;

		this.array = this.realloc(this.array, this.capacity);
	}
};

DynamicStack.prototype.shrink = function (len) {

	if (this.capacity >= len * this.grs) {

		this.capacity = len * this.growthrate;

		this.array = this.realloc(this.array, this.capacity);
	}
};

DynamicStack.prototype.push = function (value) {

	var last = this.length;

	++this.length;

	this.grow(this.length);

	this.array[last] = value;
};

/**
 * Only valid if DynamicStack#empty is false.
 */

DynamicStack.prototype.pop = function () {

	--this.length;

	var value = this.array[this.length];

	this.shrink(this.length);

	return value;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9EeW5hbWljU3RhY2suanMiXSwibmFtZXMiOlsiRHluYW1pY1N0YWNrIiwiYXJyYXkiLCJjYXBhY2l0eSIsImdyb3d0aHJhdGUiLCJyZWFsbG9jIiwibGVuZ3RoIiwiZ3JzIiwicHJvdG90eXBlIiwiZW1wdHkiLCJwZWVrIiwiZ3JvdyIsImxlbiIsInNocmluayIsInB1c2giLCJ2YWx1ZSIsImxhc3QiLCJwb3AiXSwibWFwcGluZ3MiOiI7Ozs7O2tCQU13QkEsWTs7QUFMeEI7Ozs7O0FBS2UsU0FBU0EsWUFBVCxDQUF3QkMsS0FBeEIsRUFBZ0NDLFFBQWhDLEVBQTJDQyxVQUEzQyxFQUF3REMsT0FBeEQsRUFBa0U7O0FBRWhGLE1BQUtILEtBQUwsR0FBYUEsS0FBYjtBQUNBLE1BQUtDLFFBQUwsR0FBZ0JBLFFBQWhCO0FBQ0EsTUFBS0csTUFBTCxHQUFjLENBQWQ7O0FBRUEsTUFBS0YsVUFBTCxHQUFrQkEsVUFBbEI7QUFDQSxNQUFLRyxHQUFMLEdBQVdILGFBQWFBLFVBQXhCO0FBQ0EsTUFBS0MsT0FBTCxHQUFlQSxPQUFmO0FBRUE7O0FBRURKLGFBQWFPLFNBQWIsQ0FBdUJDLEtBQXZCLEdBQStCLFlBQWE7O0FBRTNDLFFBQU8sS0FBS0gsTUFBTCxLQUFnQixDQUF2QjtBQUVBLENBSkQ7O0FBTUE7Ozs7QUFJQUwsYUFBYU8sU0FBYixDQUF1QkUsSUFBdkIsR0FBOEIsWUFBYTs7QUFFMUMsUUFBTyxLQUFLUixLQUFMLENBQVcsS0FBS0ksTUFBTCxHQUFjLENBQXpCLENBQVA7QUFFQSxDQUpEOztBQU1BTCxhQUFhTyxTQUFiLENBQXVCRyxJQUF2QixHQUE4QixVQUFXQyxHQUFYLEVBQWlCOztBQUU5QyxLQUFLLEtBQUtULFFBQUwsR0FBZ0JTLEdBQXJCLEVBQTJCOztBQUUxQixPQUFLVCxRQUFMLEdBQWdCUyxNQUFNLEtBQUtSLFVBQTNCOztBQUVBLE9BQUtGLEtBQUwsR0FBYSxLQUFLRyxPQUFMLENBQWMsS0FBS0gsS0FBbkIsRUFBMkIsS0FBS0MsUUFBaEMsQ0FBYjtBQUVBO0FBRUQsQ0FWRDs7QUFZQUYsYUFBYU8sU0FBYixDQUF1QkssTUFBdkIsR0FBZ0MsVUFBV0QsR0FBWCxFQUFpQjs7QUFFaEQsS0FBSyxLQUFLVCxRQUFMLElBQWlCUyxNQUFNLEtBQUtMLEdBQWpDLEVBQXVDOztBQUV0QyxPQUFLSixRQUFMLEdBQWdCUyxNQUFNLEtBQUtSLFVBQTNCOztBQUVBLE9BQUtGLEtBQUwsR0FBYSxLQUFLRyxPQUFMLENBQWMsS0FBS0gsS0FBbkIsRUFBMkIsS0FBS0MsUUFBaEMsQ0FBYjtBQUVBO0FBRUQsQ0FWRDs7QUFZQUYsYUFBYU8sU0FBYixDQUF1Qk0sSUFBdkIsR0FBOEIsVUFBV0MsS0FBWCxFQUFtQjs7QUFFaEQsS0FBTUMsT0FBTyxLQUFLVixNQUFsQjs7QUFFQSxHQUFFLEtBQUtBLE1BQVA7O0FBRUEsTUFBS0ssSUFBTCxDQUFXLEtBQUtMLE1BQWhCOztBQUVBLE1BQUtKLEtBQUwsQ0FBV2MsSUFBWCxJQUFtQkQsS0FBbkI7QUFFQSxDQVZEOztBQVlBOzs7O0FBSUFkLGFBQWFPLFNBQWIsQ0FBdUJTLEdBQXZCLEdBQTZCLFlBQWE7O0FBRXpDLEdBQUUsS0FBS1gsTUFBUDs7QUFFQSxLQUFNUyxRQUFRLEtBQUtiLEtBQUwsQ0FBVyxLQUFLSSxNQUFoQixDQUFkOztBQUVBLE1BQUtPLE1BQUwsQ0FBYSxLQUFLUCxNQUFsQjs7QUFFQSxRQUFPUyxLQUFQO0FBRUEsQ0FWRCIsImZpbGUiOiJEeW5hbWljU3RhY2suanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8qKlxuICogRHluYW1pY1N0YWNrI3BlZWsgb25seSB2YWxpZCBpZiBEeW5hbWljU3RhY2sjZW1wdHkgaXMgZmFsc2UuXG4gKiBEeW5hbWljU3RhY2sjcG9wIG9ubHkgdmFsaWQgaWYgRHluYW1pY1N0YWNrI2VtcHR5IGlzIGZhbHNlLlxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIER5bmFtaWNTdGFjayAoIGFycmF5ICwgY2FwYWNpdHkgLCBncm93dGhyYXRlICwgcmVhbGxvYyApIHtcblxuXHR0aGlzLmFycmF5ID0gYXJyYXkgO1xuXHR0aGlzLmNhcGFjaXR5ID0gY2FwYWNpdHkgO1xuXHR0aGlzLmxlbmd0aCA9IDAgO1xuXG5cdHRoaXMuZ3Jvd3RocmF0ZSA9IGdyb3d0aHJhdGUgO1xuXHR0aGlzLmdycyA9IGdyb3d0aHJhdGUgKiBncm93dGhyYXRlIDtcblx0dGhpcy5yZWFsbG9jID0gcmVhbGxvYyA7XG5cbn1cblxuRHluYW1pY1N0YWNrLnByb3RvdHlwZS5lbXB0eSA9IGZ1bmN0aW9uICggKSB7XG5cblx0cmV0dXJuIHRoaXMubGVuZ3RoID09PSAwIDtcblxufSA7XG5cbi8qKlxuICogT25seSB2YWxpZCBpZiBEeW5hbWljU3RhY2sjZW1wdHkgaXMgZmFsc2UuXG4gKi9cblxuRHluYW1pY1N0YWNrLnByb3RvdHlwZS5wZWVrID0gZnVuY3Rpb24gKCApIHtcblxuXHRyZXR1cm4gdGhpcy5hcnJheVt0aGlzLmxlbmd0aCAtIDFdIDtcblxufSA7XG5cbkR5bmFtaWNTdGFjay5wcm90b3R5cGUuZ3JvdyA9IGZ1bmN0aW9uICggbGVuICkge1xuXG5cdGlmICggdGhpcy5jYXBhY2l0eSA8IGxlbiApIHtcblxuXHRcdHRoaXMuY2FwYWNpdHkgPSBsZW4gKiB0aGlzLmdyb3d0aHJhdGUgO1xuXG5cdFx0dGhpcy5hcnJheSA9IHRoaXMucmVhbGxvYyggdGhpcy5hcnJheSAsIHRoaXMuY2FwYWNpdHkgKSA7XG5cblx0fVxuXG59IDtcblxuRHluYW1pY1N0YWNrLnByb3RvdHlwZS5zaHJpbmsgPSBmdW5jdGlvbiAoIGxlbiApIHtcblxuXHRpZiAoIHRoaXMuY2FwYWNpdHkgPj0gbGVuICogdGhpcy5ncnMgKSB7XG5cblx0XHR0aGlzLmNhcGFjaXR5ID0gbGVuICogdGhpcy5ncm93dGhyYXRlIDtcblxuXHRcdHRoaXMuYXJyYXkgPSB0aGlzLnJlYWxsb2MoIHRoaXMuYXJyYXkgLCB0aGlzLmNhcGFjaXR5ICkgO1xuXG5cdH1cblxufSA7XG5cbkR5bmFtaWNTdGFjay5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uICggdmFsdWUgKSB7XG5cblx0Y29uc3QgbGFzdCA9IHRoaXMubGVuZ3RoIDtcblxuXHQrK3RoaXMubGVuZ3RoIDtcblxuXHR0aGlzLmdyb3coIHRoaXMubGVuZ3RoICkgO1xuXG5cdHRoaXMuYXJyYXlbbGFzdF0gPSB2YWx1ZSA7XG5cbn0gO1xuXG4vKipcbiAqIE9ubHkgdmFsaWQgaWYgRHluYW1pY1N0YWNrI2VtcHR5IGlzIGZhbHNlLlxuICovXG5cbkR5bmFtaWNTdGFjay5wcm90b3R5cGUucG9wID0gZnVuY3Rpb24gKCApIHtcblxuXHQtLXRoaXMubGVuZ3RoIDtcblxuXHRjb25zdCB2YWx1ZSA9IHRoaXMuYXJyYXlbdGhpcy5sZW5ndGhdIDtcblxuXHR0aGlzLnNocmluayggdGhpcy5sZW5ndGggKSA7XG5cblx0cmV0dXJuIHZhbHVlIDtcblxufSA7XG4iXX0=